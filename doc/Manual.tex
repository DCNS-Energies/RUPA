%Préambule du document :
\documentclass[11pt]{report}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc} 
\usepackage[francais]{babel}
%\usepackage{multirow}
\usepackage{graphicx}
\usepackage{hhline}
\usepackage{hyperref}
\usepackage{titlesec}
\usepackage{tabularx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{pdfpages}
\usepackage{array}


\titleformat{\chapter}{\normalfont\huge}{}{20pt}{\huge \bfseries}
\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=blue
}

%\renewcommand{\chaptername}{}
\renewcommand{\thechapter}{}
\renewcommand{\thesection}{}
\renewcommand{\thesubsection}{}

\title{Recover Underwater Position by Acoustic \\ RUPA}
\author{Tristan Dewalle \\ Intern in DCNS Energies}
\date{From 06/03/2017\\To 20/07/2017}

%Corps du document :
\begin{document}
    \maketitle
	\tableofcontents
	\chapter{Introduduction}
	    %\section{Really short description of DCNS Energies}
	%	DCNS Energies is a french firm, subsidiary of DCNS. It is 
	 %   making R&D on Marine Renewable Energie, so sometimes, underwater structures are deployed
	 RUPA is an OpenCPN plugin, designed during my internship in DCNS Energies. The aim of that plugin is to 
	 have a friendly user HMI to locate underwater structures. To make that tool more efficient, I extended it 
	 to the management of the life of campaigns of measurement. In that manual, I will describe you how to use it
	 (quite simple, don't worry) and if someone want to use it to improve it, in the "Developper part" I will 
	 explicit what my logic was.

	 Ho, by the way, I'm french, so sorry if sometimes my english is too bad (don't hesitate to contact me in this case).
	\chapter{User part}
	    I hope this tool is quite easy to use, but here are some instructions, just in case.

	    Please, refer to the glossary if you're not sure what I'm talking about.
	    \section{About the devices }
		About software, RUPA was developped with:
		\begin{itemize}
		    \item Linux Mint 18.1 Serena
		    \item OpenCPN 4.4.0
		\end{itemize}

		 About the hardware: 
		\begin{itemize}
		    \item A deck unit from Sonardyne
		    \item A Transponder from Sonardyne
		    \item A FTDI (to connect computer and deck unit via USB)
		    \item A GPS from trimble (just for information)
		\end{itemize}
	    \section{Installation}
            You have to install:
            \begin{itemize}
                \item opencpn (not needed for compilation, but as it's a plugin for it...)
                \item gcc-multilib
                \item g++
                \item autotools-dev
                \item cmake
                \item wx3.0-headers
                \item liwxgtk3.0-dev
                \item libghc-zlib-dev
                \item gettext
                \item libbz2-dev
                \item libmysqlcppconn-dev 
                \item mysql-client
                \item mysql-server
            \end{itemize}
            You have to install ftd2xx too. To do that:
            \begin{itemize}
                \item go to \url{http://www.ftdichip.com/Drivers/D2XX.htm}
                \item download the good version (actually in the linux row, and for me the third or fourth column)
                \item go where you downloaded it
                \item extract it
                \item open a terminal where the folder is extracted
                \item sudo cp ./releases/build/lib* /usr/local/lib
                \item cd /usr/local/lib
                \item sudo ln -s libftd2xx.so.1.1.12 libftd2xx.so
                \item sudo chmod 0755 libftd2xx.so.1.1.12
            \end{itemize}
            If you want more explanation, please, look at the "FTDI Drivers Installation Guide for Linux".
            %If you cannot download mysqlcppconn, you can:
            %\begin{numerize}
            %    \item git clone https://github.com/mysql/mysql-connector-cpp.git
            %    \item cd path/to/mysql-connector-cpp
            %    \item cmake .
            %    \item make
            %    \item sudo make install
            %\end{numerize}
            %From \url{https://dev.mysql.com/doc/connector-cpp/en/connector-cpp-installation-source-unix.html} 

            Before launching it, you have to use the database:
            \begin{itemize}
                \item mysql -u root -p
                \item type the password you entered during installation
                \item GRANT ALL PRIVILEGES ON rupa.* TO 'youruser'@'localhost' IDENTIFIED BY 'password' 
                \item SET PASSWORD FOR 'youruser'@'localhost' = PASSWORD('')(this step is deleting the password but if you want to keep one, skip that step and set it in RUPA/src/RUPA\_Utility.h, l.62)
                \item quit
                \item mysql
                \item create database rupa
                \item quit
            \end{itemize}

            Then build RUPA:
            \begin{itemize}
                \item cd /path/where/you/want/to/download/rupa
                \item git clone https://github.com/DCNS-Energies/RUPA.git (if not already done)
                \item cd RUPA/build
                \item rm -rf * (to correct something that have to be fix no need for sudo)
                \item cmake .. .
                \item make
                \item sudo cp librupas\_pi.so /usr/lib/opencpn
                \item cd ../database
                \item mysql rupa<schema.sql
            \end {itemize}
            
	    \section{Usage}
		\subsection{Campaign}
		    It is supposed you have clicked on the "RUPA" button, while you're in OpenCPN.
		    Here, you have 2 tabs and 5 buttons. The "Current Campaign" tab list what campaigns are not finished
		    and "Finished Campaign" list what campaigns are finished.
		    \paragraph{The "New Campaign" button} allow you to enter the minimal information you use find usefull to describe
		    a campaign (the geographical area, the name of th campaign). Be careful, at this time, it's not possible 
		    to edit that simply.
		    \paragraph{The "Delete Campaign" button} remove all the datas you had got: what you entered thank's to the "New 
		    Campaign" button, but every measurement you should have done. Be really carefull, there is no way to 
		    recover what you erased (really, there is absolutely no tricks to do that).
		    \paragraph{The "Manage Campaign" button} open a new window : "Manage Campaign" in wich you can see each structure.
		    \paragraph{The "Close" button} close the window (yep, really ;-) ).
		    \paragraph{The "(Un)Finish Campaign" button} set a Campaign as finished or current, and move it to the corresponding table.

		\subsection{New Campaign}
		    \paragraph{The "Campaign's Name" field} let you name the campaign as you want.
		    \paragraph{The "Geographical Area" field} let you indicate where the campaign takes place.
		    \paragraph{The "Install Later" button} will save what you typed and show you the "Campaign" window.
		    \paragraph{The "Install Now" button} will save what you types too, but here, it redirect you to the "Manage Campaign" window.

		\subsection{Manage Campaign}

	\chapter{Developper part}

	\chapter{How to improve RUPA}
	    \section{Customization panel}
		There can be several customization panels. One of the most important is the possibility to change circles
		colors (could be done by adding a column into the database, for the measurement, then, adapt a little bit the code.
	    
	    \section{Auto detection of the structure position}
		That operation is named \emph{trilateration}, I will let a code doing that. I didn't integrate it to the plugin, because 
		it implies to make calculation on earth, and I can't spend to much time on it (it's not at all a "must have" for my project)
		I took the code frome someone else, using Eigen, the code is really small, so I let you have an eye on it. I'll put it in
		th "improvement" directory. Feel free to do what you want with that.
	    \section{Modify Campaign parameters window}
		As underlined in the user guide, there is no possibility to modifiy the parameters of a campaign (even if there is realy 
		little chance that it change, it could be nice to have the possibility to do so.

	    \section{Temporary Measurement}
		Make it possible to have a temporary measurement, probably linked to a shortcut, to make it lighter to use for who don't 
		care about campaigns (for example for divers who just have to recover something).

	    \section{RS232}
		Make it possible to configure the RS232 bus differently, and to choose what message to sent (if using other device).
		More, making instead of scanning for a message, making an interrupt-callback system. I didn't do that, because, actually, 
		I don't know how to do that (I tried a little bit with the boost library but I failed to catch a value changement), but 
		I think the current way to detect reception (by scanning) is a really dirty way to do that.


	\chapter{Glossary}
	    \paragraph{Campaign :} it regroups every single structure in one Geographical area, for a type of survey (feel free to 
	    interprate it as you want of course).
	    \paragraph{Structure :} it's an object on wich is fixed at least one transponder, and one sensor.
	    \paragraph{Burst :} a collection of measurements.
	    \paragraph{Measurement :} The distance between the transponder and the deck unit.
	    \paragraph{Deck Unit :} Human-machine interface to communicate with the transponder

\iffalse		
\chapter{chap}
	\section{sect}
		\subsection{sub}
		\begin{itemize}
		\end{itemize}
		
		\begin{enumerate}
		\end{enumerate}
		
					\begin{center} \begin{minipage}{\textwidth}
					\renewcommand{\footnoterule}{}
					\footnotetext[1]{laurem}
					\begin{tabular}{|l|l|l| || r|r|c|}
						\hline
						\multicolumn{6}{|c|}{tab}\\
						\hline
						 \\ \hline
						 \footnotemark[1]\\ \cline{3-3}
						 \multirow{6}{*}{F 1} 
%							 \multicolumn{2}{|c||}{Changement de châssis}& \multicolumn{2}{c|}{Rehausser les pièces pour le pivot}\\

%						\end{tabular}
%						\end{minipage} \end{center}

						
%						\url{perdu.com}\\
					
					
					
				
%			\appendix
%			\chapter{documents annexes, premiere div}
%			\includepdf[pages={1}]{rep/doc}
		
		\fi
\end{document}

